<div class="min-vh-100 bg-light">
  <app-header></app-header>

  <main class="py-5">
    <div class="container">
      <div class="row">
        <div class="col-12">
          <div class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="h2 mb-0">NHL Standings</h1>
            <button (click)="loadStandings()" class="btn btn-outline-primary btn-sm">
              <i class="bi bi-arrow-clockwise me-1"></i>Refresh
            </button>
          </div>
        </div>
      </div>

      <!-- Loading State -->
      <div *ngIf="loading" class="row">
        <div class="col-12 text-center">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <p class="mt-2">Loading NHL standings...</p>
        </div>
      </div>

      <!-- Error State -->
      <div *ngIf="error" class="row">
        <div class="col-12">
          <div class="alert alert-danger">
            <i class="bi bi-exclamation-triangle me-2"></i>
            {{ error }}
          </div>
        </div>
      </div>

      <div *ngIf="!loading && !error" class="row g-4">
        <!-- NHL Standings -->
        <div class="col-12">
          <div class="card shadow-sm">
            <div class="card-header bg-primary text-white">
              <h5 class="card-title mb-0">
                <i class="bi bi-trophy me-2"></i>NHL Standings
              </h5>
            </div>
            <div class="card-body p-0">
              <div class="table-responsive">
                <table class="table table-hover mb-0">
                  <thead class="table-light">
                    <tr>
                      <th scope="col" class="text-center" style="width: 50px;">#</th>
                      <th scope="col">Team</th>
                      <th scope="col" class="text-center">GP</th>
                      <th scope="col" class="text-center">W</th>
                      <th scope="col" class="text-center">L</th>
                      <th scope="col" class="text-center">OT</th>
                      <th scope="col" class="text-center">PTS</th>
                      <th scope="col" class="text-center">GF</th>
                      <th scope="col" class="text-center">GA</th>
                      <th scope="col" class="text-center">DIFF</th>
                      <th scope="col" class="text-center">PCT</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let standing of standings; let i = index" class="align-middle">
                      <td class="text-center fw-bold">{{ i + 1 }}</td>
                      <td>
                        <div class="d-flex align-items-center">
                          <img *ngIf="standing.team.logo" [src]="standing.team.logo" 
                               [alt]="standing.team.name" class="me-2" style="width: 30px; height: 30px;">
                          <div>
                            <div class="fw-bold">{{ standing.team.name }}</div>
                            <small class="text-muted">{{ standing.conference }} - {{ standing.division }}</small>
                          </div>
                        </div>
                      </td>
                      <td class="text-center">{{ standing.gamesPlayed }}</td>
                      <td class="text-center text-success fw-bold">{{ standing.wins }}</td>
                      <td class="text-center text-danger">{{ standing.losses }}</td>
                      <td class="text-center text-warning">{{ standing.overtimeLosses }}</td>
                      <td class="text-center fw-bold text-primary">{{ standing.points }}</td>
                      <td class="text-center">{{ standing.goalsFor }}</td>
                      <td class="text-center">{{ standing.goalsAgainst }}</td>
                      <td class="text-center" [ngClass]="standing.goalDifferential > 0 ? 'text-success' : 'text-danger'">
                        {{ standing.goalDifferential > 0 ? '+' : '' }}{{ standing.goalDifferential }}
                      </td>
                      <td class="text-center">{{ (standing.winPercentage * 100).toFixed(1) }}%</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- User Standings -->
        <div class="col-12">
          <div class="card shadow-sm">
            <div class="card-header bg-success text-white">
              <h5 class="card-title mb-0">
                <i class="bi bi-people me-2"></i>Pool Standings
              </h5>
            </div>
            <div class="card-body p-0">
              <div class="table-responsive">
                <table class="table table-hover mb-0">
                  <thead class="table-light">
                    <tr>
                      <th scope="col" class="text-center" style="width: 50px;">#</th>
                      <th scope="col">User</th>
                      <th scope="col" class="text-center">Correct Picks</th>
                      <th scope="col" class="text-center">Total Picks</th>
                      <th scope="col" class="text-center">Win %</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let userStanding of userStandings" class="align-middle">
                      <td class="text-center fw-bold">
                        <span *ngIf="userStanding.rank === 1" class="text-warning">
                          <i class="bi bi-trophy-fill"></i>
                        </span>
                        <span *ngIf="userStanding.rank === 2" class="text-secondary">
                          <i class="bi bi-award-fill"></i>
                        </span>
                        <span *ngIf="userStanding.rank === 3" class="text-bronze">
                          <i class="bi bi-award"></i>
                        </span>
                        <span *ngIf="userStanding.rank > 3">{{ userStanding.rank }}</span>
                      </td>
                      <td>
                        <div class="fw-bold">{{ userStanding.username }}</div>
                      </td>
                      <td class="text-center text-success fw-bold">{{ userStanding.correctPicks }}</td>
                      <td class="text-center">{{ userStanding.totalPicks }}</td>
                      <td class="text-center fw-bold" [ngClass]="{
                        'text-success': userStanding.winPercentage >= 70,
                        'text-warning': userStanding.winPercentage >= 60 && userStanding.winPercentage < 70,
                        'text-danger': userStanding.winPercentage < 60
                      }">
                        {{ userStanding.winPercentage.toFixed(1) }}%
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
